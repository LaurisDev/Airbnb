<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agregar Reseña - {{ alojamiento[1] }}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="static/estilos.css">
</head>
<body class="bg-gray-50">

    <!-- Barra de navegación -->
    <nav class="bg-white shadow-sm py-4 px-6 flex justify-between items-center sticky top-0 z-50">
        <div class="flex items-center">
            <a href="/" class="text-xl font-bold text-rose-500">Rinconcito</a>
        </div>
        <div class="flex items-center space-x-4">
            <a href="{{ url_for('detalle_alojamiento', alojamiento_id=alojamiento[0]) }}" class="text-gray-600 hover:text-rose-500 transition duration-200">
                <i class="fas fa-arrow-left mr-2"></i>Volver al alojamiento
            </a>
        </div>
    </nav>

    <!-- Contenido principal -->
    <div class="container mx-auto px-4 py-8 max-w-2xl">
        <div class="bg-white rounded-xl shadow-lg p-8">
            
            <!-- Información del alojamiento -->
            <div class="flex items-center mb-6">
                <img src="{{ alojamiento[4] }}" alt="{{ alojamiento[1] }}" class="w-16 h-16 object-cover rounded-lg mr-4">
                <div>
                    <h1 class="text-2xl font-bold text-gray-800">{{ alojamiento[1] }}</h1>
                    <p class="text-gray-600">Agregar reseña</p>
                </div>
            </div>

            <!-- Mensajes flash -->
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                        <div class="mb-4 p-4 rounded-lg {% if category == 'error' %}bg-red-100 text-red-700 border border-red-300{% elif category == 'success' %}bg-green-100 text-green-700 border border-green-300{% else %}bg-blue-100 text-blue-700 border border-blue-300{% endif %}">
                            {{ message }}
                        </div>
                    {% endfor %}
                {% endif %}
            {% endwith %}

            <!-- Formulario de reseña -->
            <form action="{{ url_for('agregar_resena_alojamiento', alojamiento_id=alojamiento[0]) }}" method="POST" class="space-y-6">
                
                <!-- Puntuación -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-3">Puntuación</label>
                    <div class="flex space-x-2" id="rating-stars">
                        {% for i in range(1, 6) %}
                        <input type="radio" id="star{{ i }}" name="puntuacion" value="{{ i }}" class="hidden" required>
                        <label for="star{{ i }}" class="text-3xl text-gray-300 hover:text-rose-500 cursor-pointer transition duration-200 star-label">
                            <i class="fas fa-star"></i>
                        </label>
                        {% endfor %}
                    </div>
                    <p class="text-sm text-gray-500 mt-2">Selecciona de 1 a 5 estrellas</p>
                </div>

                <!-- Comentario -->
                <div>
                    <label for="comentario" class="block text-sm font-medium text-gray-700 mb-2">Tu experiencia</label>
                    <textarea id="comentario" name="comentario" rows="6" required 
                              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-transparent resize-none"
                              placeholder="Comparte tu experiencia en este alojamiento... ¿Qué te gustó más? ¿Hay algo que mejorar? Tu opinión ayudará a otros viajeros."></textarea>
                    <p class="text-sm text-gray-500 mt-2">Mínimo 10 caracteres</p>
                </div>

                <!-- Botones -->
                <div class="flex space-x-4 pt-4">
                    <button type="submit" class="flex-1 bg-rose-500 text-white py-3 px-6 rounded-lg font-semibold hover:bg-rose-600 transition duration-200">
                        <i class="fas fa-paper-plane mr-2"></i>Publicar Reseña
                    </button>
                    <a href="{{ url_for('detalle_alojamiento', alojamiento_id=alojamiento[0]) }}" 
                       class="flex-1 bg-gray-300 text-gray-700 py-3 px-6 rounded-lg font-semibold hover:bg-gray-400 transition duration-200 text-center">
                        Cancelar
                    </a>
                </div>
            </form>

            <!-- Información adicional -->
            <div class="mt-8 p-4 bg-blue-50 rounded-lg">
                <div class="flex items-start">
                    <i class="fas fa-lightbulb text-blue-500 mr-3 mt-1"></i>
                    <div class="text-sm text-blue-700">
                        <p class="font-medium mb-2">Consejos para una buena reseña:</p>
                        <ul class="space-y-1">
                            <li>• Sé específico sobre lo que te gustó o no</li>
                            <li>• Menciona aspectos como limpieza, ubicación, anfitrión</li>
                            <li>• Incluye detalles que otros viajeros encontrarían útiles</li>
                            <li>• Mantén un tono respetuoso y constructivo</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Funcionalidad para las estrellas
        document.addEventListener('DOMContentLoaded', function() {
            const stars = document.querySelectorAll('.star-label');
            const radioInputs = document.querySelectorAll('input[name="puntuacion"]');
            
            stars.forEach((star, index) => {
                star.addEventListener('click', () => {
                    // Limpiar todas las estrellas
                    stars.forEach(s => s.classList.remove('text-rose-500'));
                    stars.forEach(s => s.classList.add('text-gray-300'));
                    
                    // Colorear las estrellas hasta la seleccionada
                    for (let i = 0; i <= index; i++) {
                        stars[i].classList.remove('text-gray-300');
                        stars[i].classList.add('text-rose-500');
                    }
                });
                
                star.addEventListener('mouseenter', () => {
                    // Limpiar todas las estrellas
                    stars.forEach(s => s.classList.remove('text-rose-500'));
                    stars.forEach(s => s.classList.add('text-gray-300'));
                    
                    // Colorear las estrellas hasta la actual
                    for (let i = 0; i <= index; i++) {
                        stars[i].classList.remove('text-gray-300');
                        stars[i].classList.add('text-rose-500');
                    }
                });
            });
            
            // Restaurar selección al salir del contenedor
            document.getElementById('rating-stars').addEventListener('mouseleave', () => {
                const selectedValue = document.querySelector('input[name="puntuacion"]:checked');
                if (selectedValue) {
                    const selectedIndex = parseInt(selectedValue.value) - 1;
                    stars.forEach((star, index) => {
                        if (index <= selectedIndex) {
                            star.classList.remove('text-gray-300');
                            star.classList.add('text-rose-500');
                        } else {
                            star.classList.remove('text-rose-500');
                            star.classList.add('text-gray-300');
                        }
                    });
                } else {
                    stars.forEach(star => {
                        star.classList.remove('text-rose-500');
                        star.classList.add('text-gray-300');
                    });
                }
            });
        });
    </script>
</body>
</html> 